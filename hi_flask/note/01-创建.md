+ day01 2020-05-18

## Flask

### 虚拟环境

### Flask项目结构
    + flask01

### Flask 配置和访问

```text
(venv) % python flask01/app.py
 * Serving Flask app 'app' (lazy loading)
 * Environment: production
   WARNING: This is a development server. Do not use it in a production deployment.
   Use a production WSGI server instead.
 * Debug mode: off
 * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
```

+ WSGI

+ flask 内置服务器

+ 


Flask 是一个微框架

Flask是一个基于Python实现的Web开发‘微’框架

官方：https://flask.palletsprojects.com/

https://github.com/luhuisicnu/The-Flask-Mega-Tutorial-zh

Flask和Django一样，也是一个基于MVC设计模式的Web框架

Flask依赖三个库
	Jinja2 模板引擎
	Werkzeug WSGI工具集  https://werkzeug.palletsprojects.com/en/0.16.x/

Flask流行的主要原因:
	1. 有非常齐全的官方文档，上手非常方便
	2. 有非常好的扩展机制和第三方扩展环境，工作中常见的软件都会有对应的扩展。自己动手实现扩展也很容易
	3. 社区活跃度非常高
	4. 微型框架的形式给了开发者更大的选择空间


MVC MVT

本质上与MVC没什么差别，也是各组件之间为了保持松耦合关系，只是定义上有些许不同。

Model:负责业务对象与数据库（ORM）的对象

View:负责业务逻辑，并在适当的时候调用Model和Template

Template:负责把页面展示给用户


Flask 应用
应用程序是存在于包中的。 在Python中，包含__init__.py文件的子目录被视为一个可导入的包。 当你导入一个包时，__init__.py会执行并定义这个包暴露给外界的属性。

本脚本仅仅是从flask中导入的类Flask，并以此类创建了一个应用程序对象
其一，这里有两个实体名为app。 app包由app目录和__init__.py脚本来定义构成，并在from app import route语句中被引用。 app变量被定义为__init__.py脚本中的Flask类的一个实例，以至于它成为app包的属性。
其二，route模块是在底部导入的，而不是在脚本的顶部。 最下面的导入是解决循环导入的问题，这是Flask应用程序的常见问题。 你将会看到routes模块需要导入在这个脚本中定义的app变量，因此将routes的导入放在底部可以避免由于这两个文件之间的相互引用而导致的错误。
//__init__.py
from flask  import Flask

app =Flask(__name__)

from app import route
from app import route1
 
路由是应用程序实现的不同URL。 在Flask中，应用程序路由的处理逻辑被编写为Python函数，称为视图函数。 视图函数被映射到一个或多个路由URL，以便Flask知道当客户端请求给定的URL时执行什么逻辑。
//route.py
from app import app

@app.route("/index")
def index():
    return "route"
  
程序入口
//app.py
from app import app

if __name__ == "__main__":
    app.run()
 
运行结果：
python app.py
curl http://127.0.0.1:5000/index

在cmd 中如何运行服务： 
Set  FLASK_APP=server.py
运行 flask run


### 项目结构种类
一个项目，多个应用(类似django的项目结构)
一个项目，一个应用，多个模块


### Linux   

- 环境变量
  - 系统级
    - /etc/envirtonment
    - /etc/profile
  - 用户级
    - ~/.bashrc
  - 临时级
    - 在窗口中直接export


Views
请求的流程：



路由参数获取
写法
	<converter:variable_name>
converter类型
	string 接收任何没有斜杠（‘/’）的文件（默认）
	int	接收整型
	float	接收浮点型
	path	接收路径，可接收斜线（’/’）
	uuid	只接受uuid字符串，唯一码，一种生成规则
	any	可以同时指定多种路径，进行限定

route规则
请求方法
	@app.route(‘/rule/’,methods=[‘GET’,’POST’])
	def hello():
		return ‘LOL’
methods中指定请求方法
	GET
	POST
	HEAD 
	PUT
	DELETE
url_for
	反向解析，根据函数名字，获取反向路径
	url_for(‘函数名’,参数名=value)







### flask 请求和响应
+ http 协议

+ request 
	+ 请求行
	+ 请求头
	+ 请求体

+ response
	+ 响应行
	+ 响应头
	+ 响应体
